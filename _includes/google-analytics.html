<!-- Cookie Consent Banner -->
<div id="cookie-consent-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background-color: #222; color: #fff; padding: 20px; text-align: center; display: none; z-index: 9999; font-size: 14px;">
  <p style="margin: 0 0 15px 0;">
    We use cookies to analyze site traffic and improve your experience. By clicking "Accept", you consent to our use of cookies.
    <a href="#" onclick="showCookiePolicy(event)" style="color: #4CAF50; text-decoration: none;">Learn more</a>
  </p>
  <button onclick="acceptCookies()" style="background-color: #4CAF50; color: white; border: none; padding: 10px 20px; margin-right: 10px; cursor: pointer; border-radius: 4px;">Accept</button>
  <button onclick="rejectCookies()" style="background-color: #666; color: white; border: none; padding: 10px 20px; cursor: pointer; border-radius: 4px;">Reject</button>
</div>

<script>
  // Check if user has already given consent
  function getCookie(name) {
    const nameEQ = name + "=";
    const cookies = document.cookie.split(';');
    for(let i = 0; i < cookies.length; i++) {
      let cookie = cookies[i].trim();
      if(cookie.indexOf(nameEQ) === 0) {
        return cookie.substring(nameEQ.length);
      }
    }
    return null;
  }

  function setCookie(name, value, days = 365) {
    const date = new Date();
    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
    const expires = "expires=" + date.toUTCString();
    document.cookie = name + "=" + value + ";" + expires + ";path=/";
  }

  function acceptCookies() {
    setCookie('cookie-consent', 'accepted');
    document.getElementById('cookie-consent-banner').style.display = 'none';
    loadGoogleAnalytics();
  }

  function rejectCookies() {
    setCookie('cookie-consent', 'rejected');
    document.getElementById('cookie-consent-banner').style.display = 'none';
  }

  function showCookiePolicy(event) {
    event.preventDefault();
    alert('We use Google Analytics to understand how you use our site. You can manage your preferences in your browser settings.');
  }

  function loadGoogleAnalytics() {
    // Google tag (gtag.js)
    const script1 = document.createElement('script');
    script1.async = true;
    script1.src = 'https://www.googletagmanager.com/gtag/js?id=G-Z21X4Z912Y';
    document.head.appendChild(script1);

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Z21X4Z912Y');
  }

  // Show banner if no consent decision has been made
  window.addEventListener('load', function() {
    const consent = getCookie('cookie-consent');
    if (consent === null) {
      document.getElementById('cookie-consent-banner').style.display = 'block';
    } else if (consent === 'accepted') {
      loadGoogleAnalytics();
    }
  });
</script>
